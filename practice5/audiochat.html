<!DOCTYPE html>
<html>
<head>
	<title>Audio Storage Demo</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<style type="text/css">
		table {
			border-collapse: collapse;
			margin-top: 20px;
		}
		th, td {
			padding: 10px;
			border: 1px solid black;
		}
	</style>
</head>
<body>
	<h1>Audio Storage Demo</h1>
	<form>
		<input type="file" id="audio-file">
		<button type="button" id="upload-btn">Upload</button>
	</form>
	<table>
		<thead>
			<tr>
				<th>File Name</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody id="file-list"></tbody>
	</table>
	<button type="button" id="clear-btn">Clear All</button>
	<script>
$(document).ready(function() {
	// функция для добавления файла в таблицу и хранилище
	function addFileToList(filename) {
		var row = $('<tr>').appendTo($('#file-list'));
		row.append($('<td>').text(filename));
		var deleteBtn = $('<button>').text('Delete').click(function() {
			// удаление файла из таблицы и хранилища
			var index = $(this).closest('tr').index();
			var files = JSON.parse(sessionStorage.getItem('audio_files'));
			files.splice(index, 1);
			sessionStorage.setItem('audio_files', JSON.stringify(files));
			$(this).closest('tr').remove();
			// отправка сообщения об удалении файла другим вкладкам
			window.postMessage({type: 'delete', index: index}, window.location.origin);
		}).appendTo($('<td>').appendTo(row));
		// добавление файла в хранилище
		var files = JSON.parse(sessionStorage.getItem('audio_files')) || [];
		files.push(filename);
		sessionStorage.setItem('audio_files', JSON.stringify(files));
	}
	// функция для очистки таблицы и хранилища
	function clearFileList() {
		$('#file-list').empty();
		sessionStorage.removeItem('audio_files');
		// отправка сообщения об очистке таблицы другим вкладкам
		window.postMessage({type: 'clear'}, window.location.origin);
	}
	// обработка загруз
  $('#upload-btn').click(function() {
	var file = $('#audio-file')[0].files[0];
	if (file) {
		addFileToList(file.name);
		// отправка сообщения о добавлении файла другим вкладкам
		window.postMessage({type: 'add', filename: file.name}, window.location.origin);
	}
});
// обработка сообщений от других вкладок
window.addEventListener('message', function(event) {
	if (event.origin !== window.location.origin) return;
	switch (event.data.type) {
		case 'add':
			addFileToList(event.data.filename);
			break;
		case 'delete':
			$('#file-list tr').eq(event.data.index).remove();
			break;
		case 'clear':
			clearFileList();
			break;
	}
});
// инициализация таблицы из хранилища
var files = JSON.parse(sessionStorage.getItem('audio_files')) || [];
for (var i = 0; i < files.length; i++) {
	addFileToList(files[i]);
}
// обработка кнопки очистки таблицы
$('#clear-btn').click(function() {
	clearFileList();
});
});
  </script>
</body>
</html>